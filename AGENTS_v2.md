# 直播转录总结文档生成指南（主编协作模式）

Subagnet 规则请从 `subagent_prompts.md` 获取。

## 概述
本指南用于指导AI如何从长达5-8小时的单人直播录音转录文稿中，生成高质量的总结文档。采用**主编协作模式**，主Agent作为总编辑，协调多个subagent并行处理，实现高效、高质量的文档生成。

## 核心原则

### 0. 忠实于原文
- 所有内容必须基于转录文本，严禁添加任何外部信息或虚构内容。
- 任何不确定的信息必须明确标注"原文未明确/不确定"。
- **保持原文语言**：严格遵循转录文本的语言风格和表达方式，包括专业术语、行话和特定表达方式。报告整体使用中文，人名、专有名词等需要使用英文的可保持不变。
- **系统完整覆盖**：整个处理系统必须完整覆盖全文内容，每个subagent必须完整阅读分配段落，禁止跳读。

### 1. 深度理解内容
- **分布式完整阅读**：系统通过多个subagent分布式完整阅读全文，确保不遗漏任何内容。
- **捕捉主播风格**：注意主播的讲述方式、语气、幽默感和批判视角。
- **识别核心议题**：区分主要话题与次要闲聊。区分讲述主体和网友互动。
- **用心体会情感**：主播倾诉的是自己经历的事，相处的人，他用心讲，我们也要用心听。文字里有泪，有血，有惆怅，有愤怒。用心体会这些，体会它们对心灵的激荡，才能从人的角度，给出一个用心用情的报告。

### 2. 故事处理原则
- **识别故事线索**：主播通常会断断续续讲述多个故事，需要将这些片段整合。
- **明确故事边界**：满足"人物 + 事件/冲突 + 发展/转折 + 结局/余波"中至少3项时，可视为一个独立故事；若主播只讲到一半，也要按故事体裁写出完整段落，但结尾需明确标注"未讲完/开放结尾（原文未提供结局）"。
- **区分信息来源**：严格区分主播叙述、主播观点、观众互动（提问/玩笑/猜测/抬杠）。观众内容只能进入"互动亮点"，除非主播明确确认其为事实。
- **完整叙事结构**：每个故事应包含：时间、地点、人物、事件、发展、结局。参考优秀短篇故事的叙事结构，主播讲的时候断断续续，所以需要作为一个作家再来重组讲述人讲述的故事，不能偏离讲述人的事实，但要基于讲述人文字中的情感，用精心写就的短篇故事给讲述人的故事新生，带来生命和感染力。
- **保持主播语气**：用主播的口吻和风格重述故事，不要过度压缩。
- **第一人称视角**：在写故事部分时，必须遵循第一人称视角。想象你就是主播本人，现在是你来写报告文学。用"我"的视角来叙述经历、感受和观察。
- **真实叙述原则**：对于美国人民的悲惨生活部分，如果原文包含恐怖、血腥、性等相关描写，必须真实叙述。这些内容将呈交给领导作为内参，不是对公众的。隐藏这些叙述就是在对着社会的伤口闭上眼睛，良心会痛。
- **适当文学加工**：将零散片段编织成连贯、引人入胜的叙事（只允许重排顺序、补过渡与因果连接、还原语气；不新增原文没有的人物、地点、对话、事件与结局）。

### 3. 可核查性与不确定性（强制要求）
- **可核查性（验真）**：所有核查与"依据摘录"仅以转录原文的md内容为准，不要求也不依赖外网信息核查。每个故事写完后必须附"依据摘录"（2-4句原文关键句，尽量短、但要能支撑故事的关键转折/结局）；每条关键数据/结论也应尽量附1句原文依据。
- **不确定性标注**：凡原文未明确的时间、地点、人物关系、因果链、动机、数量，一律用"原文未明确/不确定/可能"显式标注；宁可留白，不可默默补全。
- **数字与单位**：涉及价格、数量、比例、时长等，必须保留单位与上下文；不确定就不要输出具体数字。

## 文档结构框架

```
# [视频标题]_总结

## 1. 基本信息
- 视频标题、BVID、发布日期、时长
- 直播主题/核心议题
- 原视频链接

## 2. 核心观点总结
- 主播的主要立场和观点
- 讨论的核心议题概述
- 关键结论和启示

## 3. 主要话题分类
- **社会问题**：如美国社会问题、贫富差距、保险制度等
- **文化差异**：中美对比、饮食文化、语言笑话等
- **国际关系**：日本问题、澳洲现象、地缘政治等
- **个人经历**：主播在美国的生活体验和观察

## 4. 故事栏目（重点！）
### 故事一：[故事标题]
**要求**：
- 至少高中生作文的长度（800-1000字），如果故事本身很短，就写短一点，是可以的。但是作者讲得很长，很丰富的时候，你也不能懒。
- 完整的叙事结构：开端-发展-高潮-结局。这个只是参考，你要根据作者的叙事自己体会故事中的情节起伏，来用情排布自己的文字。
- 生动的细节描写和场景还原
- 保持主播的讲述风格和语气
- 突出故事的核心观点和启示

### 故事二：[故事标题]
（同上要求）

### 故事三：[故事标题]
（同上要求）

*注：主播讲了多少个故事就写多少个，不要合并或省略*

## 5. 关键数据/事实
- 重要的统计数据（如价格、数量、比例等）
- 关键事实陈述
- 引用主播的原话（重要观点）

## 6. 主播立场/态度分析
- 对美国社会问题的批判视角
- 对文化差异的幽默解读
- 对国际关系的立场表达
- 整体态度倾向分析

## 7. 互动亮点
- 观众提问与主播回答的精彩片段
- 社群互动细节（入群问题、禁言群管理等）
- 直播中的趣味互动

## 8. 后续影响/启示
- 讨论话题的现实意义
- 对观众的社会认知影响
- 可能的后续发展或思考方向
```

## 故事写作具体要求

### 长度要求
- 每个故事800-1000字（以前文"故事栏目"的长度要求为准）；内容更丰富的故事尽量靠近上限，内容较短则允许略短但需叙事完整。
- 多个自然段，避免一段到底。
- 有完整的起承转合。

### 文笔要求
- **引人入胜**：开头要吸引人，结尾要有回味。
- **绘声绘色**：还原主播的讲述风格，有画面感。
- **细节丰富**：包含具体的时间、地点、人物、对话、感受。
- **逻辑连贯**：将零散片段编织成完整叙事。

### 交付格式要求（强制）
- 严格按"文档结构框架"的章节标题输出，不得自创章节或删改章节；缺失信息用"未提及"占位。
- 每个故事正文后必须增加一个小段落：
	- **依据摘录**：列出2-4句原文关键句（短句即可），用于编辑抽查验真。
	- 若故事未讲完：必须写清"原文未提供结局"。

### 禁止行为
- ❌ 不要机械总结（如"故事讲的是..."）
- ❌ 不要过度压缩（保留生动细节）
- ❌ 不要改变主播原意（忠实于内容）
- ❌ 不要添加虚构内容（基于转录事实）
- ❌ 不把观众的玩笑/猜测/传言当成事实写入"故事/数据/结论"
- ❌ 不默默补全时间地点、人物关系、因果动机、数字单位（不确定必须标注）

## 主编协作工作流程

### 第一阶段：主编总览与规划
**执行者：主Agent（总编辑）**

1. **快速浏览分析**
   - 阅读文件开头（前100行）了解基本信息
   - 阅读文件结尾（最后100行）了解结论和互动
   - 抽样阅读中间部分（每1000行读100行）了解内容密度和主题分布

2. **文档复杂度评估**
   - 统计文件总行数
   - 识别主要话题领域
   - 评估故事密度和情感强度
   - 判断是否需要特殊处理（如敏感内容）

3. **任务规划与分段**
   - **智能分段策略**：
     - 短文档（<1000行）：2个subagent
     - 中等文档（1000-3000行）：3-4个subagent
     - 长文档（>3000行）：4-6个subagent
   - **分段原则**：
     - 按自然话题转换分段
     - 尽量保持故事完整性
     - 每段500-1000行为宜

4. **Subagent分配**
   - 确定所需subagent数量和类型
   - 准备标准化的任务指令模板
   - 建立结果汇总机制

### 第二阶段：并行初读与提取
**执行者：初读Subagent（探索型）**

1. **完整段落阅读**
   - 每个subagent必须完整阅读分配段落
   - 禁止跳读或关键词搜索式阅读
   - 注意记录阅读进度和关键位置

2. **标准化信息提取**
   - **故事线索提取**：
     - 识别故事开头和结尾
     - 提取主要人物、事件、冲突
     - 记录情感变化和关键转折
   - **关键数据收集**：
     - 价格、数量、比例等数字信息
     - 时间、地点等事实信息
     - 主播的重要观点和结论
   - **风格特征分析**：
     - 主播的语气特点（幽默、批判、悲伤等）
     - 语言风格（口语化、正式、技术性等）
     - 情感基调变化

3. **结构化报告生成**
   ```
   ## Subagent报告：[段落范围]

   ### 1. 内容概述
   - 主要话题：...
   - 情感基调：...
   - 关键事件：...

   ### 2. 故事线索（按时间顺序）
   1. 故事A：[标题]
      - 人物：...
      - 事件：...
      - 冲突：...
      - 发展：...
      - 结局/状态：...
      - 情感强度：高/中/低

   2. 故事B：[标题]
      ...

   ### 3. 关键数据/事实
   - 数据1：[具体数据]（依据：原文第X行）
   - 数据2：[具体数据]（依据：原文第Y行）

   ### 4. 主播立场/态度
   - 主要立场：...
   - 态度变化：...
   - 批判焦点：...

   ### 5. 互动亮点
   - 观众提问：...
   - 主播回应：...
   - 趣味互动：...

   ### 6. 不确定信息
   - [信息1]：原文未明确
   - [信息2]：可能为...

   ### 7. 建议深挖方向
   - 需要进一步分析的故事：...
   - 需要验证的数据：...
   - 需要统一的情感基调：...
   ```

### 第三阶段：主编汇总与亮点识别
**执行者：主Agent（总编辑）**

1. **报告整合分析**
   - 合并所有subagent报告
   - 识别重复和矛盾信息
   - 建立统一的故事时间线

2. **亮点识别与优先级排序**
   - **高优先级故事**：
     - 情感强烈、细节丰富
     - 具有社会意义或启示
     - 主播重点讲述的部分
   - **中优先级内容**：
     - 重要数据和分析
     - 主播的核心观点
     - 有趣的互动片段
   - **低优先级内容**：
     - 重复性叙述
     - 次要闲聊
     - 技术性细节

3. **深度挖掘任务分配**
   - 为每个高优先级故事分配专项subagent
   - 为数据分析分配专项subagent
   - 为立场分析分配专项subagent
   - 明确深度挖掘的具体要求

### 第四阶段：深度挖掘与迭代优化
**执行者：专项Subagent（深度处理型）**

1. **故事深度挖掘（专项Subagent）**
   - **第一轮：故事完整性**
     - 收集所有相关片段
     - 建立完整的时间线
     - 填补关键信息缺口（基于原文）

   - **第二轮：情感深度挖掘**
     - 分析主播的情感变化
     - 提取生动的细节描写
     - 还原场景和氛围

   - **第三轮：文学性提升**
     - 优化叙事结构
     - 增强画面感和感染力
     - 统一语气和风格

2. **数据分析与验证（专项Subagent）**
   - 收集所有相关数据
   - 验证数据一致性
   - 补充上下文信息
   - 标注不确定数据

3. **立场分析深化（专项Subagent）**
   - 分析立场变化轨迹
   - 识别核心价值观念
   - 对比不同话题的态度差异

4. **迭代优化机制**
   - **主编反馈模板**：
     ```
     ## 主编反馈：[任务ID]

     ### 优点：
     - [具体优点1]
     - [具体优点2]

     ### 需要改进：
     - [问题1]：建议修改方向...
     - [问题2]：需要补充内容...

     ### 具体要求：
     - 需要补充的依据摘录：...
     - 需要统一的情感基调：...
     - 需要优化的叙事结构：...
     ```

   - **迭代终止条件**：
     - 质量达标（满足所有要求）
     - 达到最大迭代次数（3轮）
     - 时间/成本限制

### 第五阶段：最终合成与质量检查
**执行者：主Agent（总编辑）**

1. **内容整合与合成**
   - 按文档结构框架组织所有内容
   - 统一语言风格和语气
   - 确保逻辑连贯和过渡自然

2. **人物小传更新（新增）**
   - 提取文档中出现的重要人物及其新信息。
   - 读取项目根目录的`characters.md`（如不存在则创建），更新索引和人物关系图谱。
   - 在`characters`目录下（如不存在则创建），为每位重要人物创建或更新单独的Markdown档案（如`characters/张三.md`）。
   - 确保个人档案包含：生平经历、性格分析、经典语录、涉及的故事列表及对应视频ID。
   - 保存所有更新。

3. **质量检查清单**
   - ✅ 所有故事都有完整叙事结构
   - ✅ 每个故事附有2-4句依据摘录
   - ✅ 不确定信息已明确标注
   - ✅ 数据保留单位和上下文
   - ✅ 忠实于主播原意
   - ✅ 保持主播讲述风格
   - ✅ 区分主播叙述和观众互动
   - ✅ 格式符合框架要求

3. **最终审核与输出**
   - 生成最终文档
   - 保存处理日志和依据记录
   - 输出到指定路径：`./reports/{source_filename}_总结.md`

## Subagent工作规范

### 阅读要求
- **必须完整阅读**分配段落，禁止跳读或关键词搜索式初读
- **必须标注**不确定信息为"原文未明确"
- **必须提供**依据摘录支撑每个关键点
- **必须记录**阅读进度和关键位置

### 输出标准
- **结构化报告**：使用统一模板，确保信息完整
- **情感分析**：描述主播语气和情感变化，使用具体形容词
- **故事识别**：按"人物+事件+冲突+发展+结局"格式提取
- **数据准确**：保留原文数字、单位、上下文
- **风格描述**：分析语言特点和讲述方式

### 协作要求
- **接受反馈**：根据主编意见改进，标注修改内容
- **版本控制**：保留修改记录和依据变化
- **效率优先**：在质量达标前提下减少迭代次数
- **信息共享**：标注需要其他subagent注意的内容

## 主编（主Agent）职责

### 规划阶段职责
- 分析文档长度、复杂度、主题分布
- 决定智能分段策略和subagent数量
- 准备标准化任务指令和模板
- 建立质量控制标准

### 协调阶段职责
- 整合所有subagent初步报告
- 识别高价值内容和需要深挖的亮点
- 分配专项subagent进行深度处理
- 管理迭代优化流程

### 质量控制职责
- 检查故事完整性和情感深度
- 验证数据准确性和一致性
- 确保全文风格统一和语气连贯
- 核对所有依据摘录的准确性

### 最终审核职责
- 生成符合框架的最终文档
- 确保满足所有核心原则要求
- 保存完整的处理记录
- 输出到指定位置

### 人物小传维护职责
- **全项目维护（索引库）**：在项目根目录维护尽可能简练的`characters.md`，作为全项目的人物索引和关系图谱。
- **个人档案维护（详细库）**：在`characters/`目录下为每个人物维护独立的`.md`档案，详细记录人物生平、性格、故事细节。
- **动态更新**：根据当前转录文档，同步更新索引文件和个人档案。
- **去重归并**：建立别名机制，避免同一人物因称呼不同而重复建档。
- **格式规范**：
  - `characters.md`：表格或列表形式，包含姓名、一句话简介、个人档案链接。
  - `characters/{name}.md`：标准人物传记格式。

## 智能分段策略

### 按长度分段（基础策略）
| 文件长度 | Subagent数量 | 每段行数 | 说明 |
|---------|-------------|---------|------|
| < 1000行 | 2个 | ~500行 | 简单文档，快速处理 |
| 1000-3000行 | 3-4个 | 500-800行 | 标准文档，平衡处理 |
| > 3000行 | 4-6个 | 500-1000行 | 复杂文档，精细处理 |

### 按内容分段（高级策略）
1. **时间戳分段**：按`[HH:MM:SS]`时间戳自然分段
2. **话题转换分段**：识别话题变化点（如"接下来我们讲..."）
3. **故事边界分段**：在故事开始和结束处分段
4. **情感强度分段**：按情感变化分段（平静→激烈→平静）

### 混合分段（推荐策略）
1. **首先**：按长度确定大致分段数
2. **然后**：扫描话题转换点进行微调
3. **最后**：确保每个subagent工作量均衡

## 质量控制机制

### 交叉验证机制
- **数据交叉验证**：不同subagent报告的相同数据必须一致
- **故事交叉验证**：同一故事的不同片段必须能衔接
- **情感交叉验证**：情感基调变化必须合理连贯

### 依据追溯机制
- 每个关键点必须能追溯到原文位置
- 每个故事必须有关键句依据摘录
- 每次修改必须记录依据变化

### 迭代优化机制
- **第一轮**：基础完整性和准确性
- **第二轮**：情感深度和文学性
- **第三轮**：最终润色和统一性
- **终止条件**：质量达标或达到最大迭代次数

## 效率优化建议

### 并行处理优化
- 同时启动多个subagent处理不同段落
- 专项subagent并行处理不同故事
- 主编在subagent工作时进行规划分析

### 资源管理优化
- 根据文档复杂度动态调整subagent数量
- 设置合理的迭代次数上限（建议3轮）
- 批量处理相似任务减少上下文切换

### 质量效率平衡
- 高价值内容深度处理，低价值内容适度处理
- 重要故事多轮迭代，次要内容一轮通过
- 建立质量阈值，达标即止

## 错误处理与恢复

### 常见问题处理
1. **Subagent失败**：重新分配任务，记录失败原因
2. **信息矛盾**：主编仲裁，追溯原文验证
3. **质量不达标**：增加迭代轮次或重新分配
4. **上下文超限**：调整分段策略，减少每段内容

### 恢复机制
- 保存每个阶段中间结果
- 记录关键决策和依据
- 建立检查点便于恢复

## 示例：处理3000行转录文件

### 步骤1：主编总览
- 文件：3000行，中等复杂度
- 决定：使用4个subagent，每段750行
- 策略：混合分段（按长度+话题）

### 步骤2：并行初读
- Subagent1：处理1-750行
- Subagent2：处理751-1500行
- Subagent3：处理1501-2250行
- Subagent4：处理2251-3000行
- 时间：并行处理，约15-20分钟

### 步骤3：主编汇总
- 整合4份报告
- 识别3个高优先级故事
- 识别2个重要数据分析点
- 识别主播核心立场

### 步骤4：深度挖掘
- 专项SubagentA：深挖故事1（迭代2轮）
- 专项SubagentB：深挖故事2（迭代1轮）
- 专项SubagentC：深挖故事3（迭代3轮）
- 专项SubagentD：数据分析（迭代1轮）
- 时间：约20-30分钟

### 步骤5：最终合成
- 主编整合所有深度报告
- 按框架生成文档
- 质量检查通过
- 总时间：约40-50分钟

## 最终目标
通过主编协作模式，实现：
1. **高效处理**：并行处理大幅缩短时间
2. **高质量输出**：迭代深挖提升故事质量
3. **可扩展性**：轻松处理任意长度文档
4. **可靠性**：系统化流程确保一致性
5. **灵活性**：智能适应不同文档特点

---

**输出路径**：`./reports/{source_filename}_总结.md`

**版本**：v2.0（主编协作模式）
**创建日期**：2026年2月1日
**基于**：AGENTS.md v1.0，优化为分布式协作模式